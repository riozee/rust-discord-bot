# 🤖 rust-bot 開発のやり方

このドキュメントは、開発の進め方とか、テスト用の Bot を作る方法とかをまとめたものです。

-----

## 🛠️ まずは準備から

### 1\. Rust のインストール

まだの人は、 Rust を入れといてね。

### 2\. リポジトリをフォーク & クローン

まず、このリポジトリを **Fork** して、自分の GitHub アカウントにコピーを作ろう。

次に、そのコピーしたリポジトリ（自分のリポジトリ）を PC に持ってくる。

```bash
# 「your-username」の部分は自分の GitHub ユーザー名に書き換えてね！
git clone https://github.com/your-username/rust-discord-bot.git
cd rust-discord-bot
```

### 3\. 依存関係のインストール

下のコマンドを叩けば、必要なライブラリとかが全部インストールされるよ。

```bash
cargo build
```

-----

## 💻 開発の基本的な流れ

### 1\. 作業場所を最新の状態にする

作業を始める前に、本家リポジトリの最新の変更を取り込んで、自分のローカル環境を最新にしておこう！

```bash
# まだ設定してない人だけ：本家リポジトリを 'upstream' として登録する
git remote add upstream https://github.com/riozee/rust-discord-bot.git

# 本家(upstream)の最新情報を取ってくる
git fetch upstream

# 自分の main ブランチに移動して、本家の main ブランチの内容をマージする
git checkout main
git merge upstream/main
```

### 2\. ブランチを作る

`main` ブランチはいつでもちゃんと動く状態にしときたいから、直接いじるのはやめよう 🙅
作業する前に、必ず新しいブランチを作ってね！

```bash
# 新しいブランチを作成（ブランチ名は分かりやすく！）
git checkout -b feature/〇〇機能の追加
```

### 3\. コーディング！

作ったブランチで、自由にコードを書いて機能を追加したり、バグを直したりして OK！

### 4\. 動作テスト（超重要！）

コードを変えたら、**コミットする前に必ず自分の PC でテストしてね。**
やり方は一番下に書いてある「**🔧 テスト用の Bot を作る方法**」を見て！

### 5\. コミット & プッシュ

ちゃんと動くことが確認できたら、変更をコミットして **自分のフォークしたリポジトリ** にプッシュしよう。

```bash
git add .
git commit -m "feat: 〇〇機能を追加したよ！" # コミットメッセージは分かりやすく
git push origin feature/〇〇機能の追加
```

### 6\. プルリクエスト (PR) を作成

GitHub で、さっきプッシュしたブランチから本家リポジトリの `main` ブランチへのプルリクエスト（PR）を作ってね。

PR のコメントには、こんなことを書くとレビューする人が助かります

  * **何を変えたか？**
  * **なんで変えたか？**
  * **（もしあれば）動作確認のスクショや GIF**

PR くれたら誰かが見て、問題なさそうならマージしてボットを更新するよ！👍

### ⭐️ もっと開発したい人へ

もし、これからもっとたくさん開発に協力してくれる！という人は、毎回フォークするのは大変だと思うので、気軽に声をかけてね！このリポジトリへの書き込み権限を招待します！🎉

-----

## 🔧 テスト用の Bot を作る方法

本番の Bot に影響が出ないように、開発中は自分専用のテスト Bot を使おう！

1.  **Discord Developer Portal を開く**

      * [Discord Developer Portal](https://discord.com/developers/applications) にアクセスして「**New Application**」をクリック。
      * Bot の名前は適当で OK（例: `test-bot-自分の名前`）。

2.  **Bot を作ってトークンをコピー**

      * 左のメニューから「**Bot**」タブを選んで「**Add Bot**」をクリック。

      * 「**TOKEN**」のところにある「**Reset Token**」か「**View Token**」を押して、表示されたトークンをコピー。**このトークンはパスワードみたいなものだから、絶対に人に教えたり、GitHub に上げたりしちゃダメだよ！** 🤫

3.  **メッセージが読めるように設定**

      * 「**Privileged Gateway Intents**」っていう項目の中にある「**MESSAGE CONTENT INTENT**」をオンにする。これを忘れるとメッセージが読めないから注意！

4.  **自分のサーバーに Bot を招待**

      * 左のメニューの「**OAuth2**」→「**URL Generator**」を開く。

      * 「**SCOPES**」で「`bot`」にチェックを入れる。

      * 「**BOT PERMISSIONS**」で必要な権限（とりあえず`Send Messages`とか`Read Message History`で OK）を選ぶ。

      * 下に表示された URL をコピーしてブラウザで開き、テストしたいサーバーに招待しよう。

5.  **`.env`ファイルを作る**

      * プロジェクトのフォルダ直下に `.env` という名前のファイルを作る。

      * そのファイルの中に、さっきコピーした Bot のトークンを貼り付ける。

        ```env
        # .env
        DISCORD_TOKEN="ここにさっきコピーしたトークンを貼り付け"
        ```

6.  **Bot を起動！**

      * ターミナルで下のコマンドを叩けば、君の PC で Bot が動き出すよ！

        ```bash
        cargo run
        ```

      * サーバーに招待したテスト Bot がちゃんと動くか確認してみよう！
